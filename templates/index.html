<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="static/img/favicon.ico">

    <title>shitstream</title>

    <link href="static/css/bootstrap.min.css" rel="stylesheet">
    <link href="static/css/main.css" rel="stylesheet">
  </head>

  <body>

    <script type="text/x-handlebars">
      <div class="container">
        <div class="navbar navbar-default" role="navigation">
          <div class="container-fluid">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              {{#link-to 'index' class='navbar-brand'}}shitstream{{/link-to}}
            </div>
            <div class="collapse navbar-collapse">
              <ul class="nav navbar-nav">
                <li>{{#link-to 'artists'}}Browse{{/link-to}}</li>
                <li>{{#link-to 'playlist' 'current'}}Queue{{/link-to}}</li>
                <li>{{#link-to 'add_url'}}Add URL{{/link-to}}</li>
              </ul>
              <ul class="nav navbar-nav navbar-right">
                <li>
                  <a href="/mpd.mp3.m3u">
                    <span class="glyphicon glyphicon-music"></span> Stream
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div id="alert-placeholder">
      </div>

      <div class="container">
        {{outlet}}
      </div>
    </script>

    <script type="text/x-handlebars" id="index">
      <div class="row">
        <div class="col-md-12">
          <div class="page-header">
            <h1>Notes</h1>
          </div>
          <h3>If you done goof, consequences will never be the same</h3>
          <p>I'm not a violent man, but if you fuck with anything here, I <strong>will</strong> kill you.</p>
          <p>This is a pre-alpha, hemorrhaging-edge attempt at creating a collaborative online radio station.  Due to lack of resources (mainly time and motivation), most of what you see here is figuratively held together with duct tape and twine.  The music library that is used by this site is my personal one, and I <strong>don't</strong> have a backup (again, lack of resources).  If you find a bug, vulnerability, what have you, let me know via IRC or file a bug at <a href="https://github.com/nijotz/shitstream">https://github.com/nijotz/shitstream</a>.</p>
          <h3>Room for improvement</h3>
          <p>Be careful how much you queue, there isn't any way to remove from the queue via the web interface yet.</p>
          <p>This uses Ember.js, a "one-page" framework.  I haven't worked out all the kinks, so if you try to queue something, and it says that it queued, but you don't see it in the queue: refresh.</p>
          <p>If you add a song via URL, and want to add another one, sometimes it doesn't work a second time: refresh.</p>
          <h3>Trumpets</h3>
          <p>If you tune in and hear trumpets, nothing is queued.  That's what plays when nothing is queued.  Even if songs are listed in the queue, that doesn't mean they're playing.  The queue shows songs that have been played as well as the currently playing song and songs that will be played.  The interface sucks, so you can't see what's what.  Trumpets means the queue is all songs that have been played.</p>
        </div>
      </dvi>
    </script>

    <script type="text/x-handlebars" id="artists">
      <div class="row">
        <div class="col-md-4">
          <div class="list-group">
            {{#each}}
            {{#link-to 'artist' this class="list-group-item"}}
            {{name}}
            {{/link-to}}
            {{/each}}
          </div>
        </div>

        <div class="col-md-8">
          {{outlet}}
        </div>
      </div>
    </script>

    <script type="text/x-handlebars" id="playlist">
      <div class="row">
        <div class="col-md-12">
          {{!-- FIXME Duplicated from "songs" template.  Couldn't figure out
                how to reuse properly and want to move forward --}}
          <table class="table">
            <thead>
              <tr>
                <th>Position</th>
                <th>Artist</th>
                <th>Album</th>
                <th>Title</th>
                <th>Length</th>
                <th>Filename</th>
                <th>Remove</th>
              </tr>
            </thead>
            {{#each songs}}
              <tr {{bind-attr class="playing:success"}}>
                <td>{{pos}}</td>
                <td>{{song.artist.name}}</td>
                <td>{{song.album.name}}</td>
                <td>{{song.title}}</td>
                <td>{{song.length}}</td>
                <td>{{song.file}}</td>
                <td>
                  <button {{action "dequeue_song" this}} class="close" type="button">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                  </button>
                </td>
              </tr>
            {{/each}}
          </table>
        </div>
      </div>
    </script>

    <script type="text/x-handlebars" id="artist">
      <h1>{{name}}</h1>
      <h2>Albums</h2>
      <table class="table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Queue</th>
          </tr>
        </thead>
        {{#each albums}}
        <tr>
          <td>
            {{#link-to 'album' this}}{{name}}{{/link-to}}
          </td>
          <td>
            <button {{action "queue_album" this}}>
              <span class="glyphicon glyphicon-plus"></span>
            </button>
          </td>
        </tr>
        {{/each}}
      </table>
      <h2>Non-Album Songs</h2>
      {{render "songs" non_album_songs}}
    </script>

    <script type="text/x-handlebars" id="album">
      <div class="row">
        <div class="col-md-8">
          <h1>{{name}}</h1>
          <h2>Songs</h2>
          {{render "songs" songs}}
        </div>
      </div>
    </script>

    <script type="text/x-handlebars" id="songs">
      <table class="table">
        <thead>
          <tr>
            <th>Artist</th>
            <th>Album</th>
            <th>Title</th>
            <th>Length</th>
            <th>Filename</th>
            <th>Queue</th>
          </tr>
        </thead>
        {{#each}}
          <tr {{bind-attr class="playing:success"}}>
            <td>{{artist.name}}</td>
            <td>{{album.name}}</td>
            <td>{{title}}</td>
            <td>{{length}}</td>
            <td>{{file}}</td>
            <td>
              <button {{action "queue_song" this}}>
                <span class="glyphicon glyphicon-plus"></span>
              </button>
            </td>
          </tr>
        {{/each}}
      </table>
    </script>

    <script type="text/x-handlebars" id="add_url">
      <div class="row">
        <div class="col-md-12">
          <div class="content">
            <p>Put a URL to a song in the box below to add it to the queue.</p>
            <p>Currently, only YouTube URLs are supported</p>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-md-8">
          <div class="input-group">
              <span class="input-group-addon"><span class="glyphicon glyphicon-link"></span></span>
            {{input type="text" class="form-control" placeholder="https://www.youtube.com/watch?v=dQw4w9WgXcQ" value=url}}
          </div>
          <br></br>
        </div>
        <div class="col-md-4">
          <button id="queue-btn" class="btn btn-default" {{action "queue_url" url}}>
            Add URL to Queue
          </button>
        </div>
      </div>

      <div class="row">
        <div class="col-md-12">
          <pre id="messages" class="well"></pre>
        </div>
      </div>

    </script>

    <script src="static/js/lib/jquery-1.10.2.js"></script>
    <script src="static/js/lib/bootstrap.min.js"></script>
    <script src="static/js/lib/handlebars-1.1.2.js"></script>
    <script src="static/js/lib/ember-1.7.0.js"></script>
    <script src="static/js/lib/ember-data-1.0.0-beta9.js"></script>
    <script src="static/js/lib/socket.io-0.9.16.js"></script>
    <script src="static/js/app.js"></script>
  </body>
</html>
